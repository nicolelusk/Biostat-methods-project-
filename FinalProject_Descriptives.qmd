---
title: "Descriptive Statistics"
format: html
---


### Research Question and Variables to be Included

How does fasting influence insulin and cholesterol levels in adult men and women? 

In our final project we will look at gender, length of food fast (hours), length of coffee/tea fast (hours), length of alcohol fast(hours) to understand how different fasting aspect will affect two continuous outcome variables, insulin and cholesterol. 

We will also take into account individuals that have diabetes, as their insulin regulation is compromised. 

```{r}
library("here")
library("haven")
library("tidyverse")
Demographics<-read_xpt(here("DEMO_L.xpt"))
Fasting<-read_xpt(here("FASTQX_L.xpt"))
Insulin<-read_xpt(here("INS_L.xpt"))
Cholesterol<-read_xpt(here("TCHOL_L.xpt"))
Diabetes<-read_xpt(here("DIQ_L.xpt"))


FullData_df<-Demographics|>
  full_join(Fasting, by = "SEQN")|>
  full_join(Insulin, by = "SEQN")|>
  full_join(Cholesterol, by = "SEQN")|>
  full_join(Diabetes, by = "SEQN")

Data_df<-FullData_df|> 
  select("SEQN", "RIAGENDR", "RIDAGEYR", "PHQ020", "PHACOFHR", "PHQ030", "PHAALCHR", "PHAFSTHR", "LBXTC", "LBXIN", "DIQ010", "DIQ050", "DIQ160")|>
  rename("Sequence" = SEQN,
         "Sex" = RIAGENDR,
         "Age" = RIDAGEYR,
        "Coffee_or_Tea_Factor" = PHQ020, "Hrs_CoffeeTea" = PHACOFHR, 
        "Alcohol_Factor" = PHQ030, "Hrs_Alcohol" = PHAALCHR,
        "Hrs_Food" = PHAFSTHR, 
        "Cholesterol" = LBXTC,
        "Insulin" = LBXIN,
        "Diabetes" = DIQ010, "Taking_Insulin" = DIQ050, "Prediabetes" = DIQ160)|>
  mutate(Sex = case_when(Sex == 1 ~"male", 
                         Sex == 2 ~ "female"),
         Coffee_or_Tea_Factor = case_when(Coffee_or_Tea_Factor == 1 ~ "yes",
                                          Coffee_or_Tea_Factor == 2 ~"no",
                                          .default = NA),
         Alcohol_Factor = case_when(Alcohol_Factor == 1 ~ "yes",
                                 Alcohol_Factor == 2 ~ "no", 
                                 .default = NA),
         Diabetes = ifelse(Diabetes == 1, "yes", "other"),
         Prediabetes = ifelse(Prediabetes == 1, "yes", "other"),
         Taking_Insulin = ifelse(Taking_Insulin == 1, "yes", "other"))

```

Cholesterol = mg/dL
Insulin = uU/mL

Coffee_or_Tea_Factor = Whether or not an individual fasted from coffee/tea
Same as alcohol 


### Single Variable Visualizations



#### Age

```{r}
Data_df|>summarise(mean = mean(Age),
                   sd = sd(Age))

ggplot(data = Data_df, aes(x = Age))+
  geom_histogram()+
  theme_minimal()
```

From our exploration we can see that the distribution of sex in our dataset is a little bimodal, with more individuals between 0-20 and 60-80. In our numerical summary we can see that the mean is 38.3 years old. 

#### Coffee Fast & How Long

```{r}
Data_df|>group_by(Coffee_or_Tea_Factor)|>
  filter(Coffee_or_Tea_Factor == "no"|
           Coffee_or_Tea_Factor == "yes")|>
  summarise(n = n())

coffee_fast<-Data_df|> filter(Coffee_or_Tea_Factor == "yes")

ggplot(data = coffee_fast, aes(y = Hrs_CoffeeTea))+
  geom_boxplot()+
  theme_minimal()

coffee_fast|> summarise(mean = mean(Hrs_CoffeeTea),
                        sd = sd(Hrs_CoffeeTea))
```

Here we can see that only 29 people fasted from coffee/tea. Those that did fast are displayed in the above boxplot, which shows us that the majority of fasting time lies between ~4-11 hours. From a specific numerical summary we can see that the mean fasting time from coffee and tea was 7.55, and there was some spread with the standard deviation falling at 5.88.

#### Cholesterol 

```{r}
Data_df|> summarise( mean = mean(Cholesterol, na.rm = TRUE),
                     sd = sd(Cholesterol, na.rm = TRUE))

ggplot(data = Data_df, aes(x = Cholesterol))+
  geom_histogram()+
  theme_minimal()
```

We can see that cholesterol presents as a unimodal distribution, with a mean around 182 and sd of 42.3. From our histogram, we can see the peak seems to be localized between the 150 and 250 range. 


### Bivariate Visualization 

```{r}
ggplot(data = Data_df, aes(x = Hrs_Food, y = Cholesterol, color = factor(Diabetes)))+
  geom_point(na.rm = TRUE)+
  geom_smooth(method = 'lm', se = FALSE)
  

ggplot(data = Data_df, aes(x = Hrs_Alcohol, y = Cholesterol, color = factor(Diabetes)))+
  geom_point(na.rm = TRUE)

ggplot(data = Data_df, aes(x = Hrs_CoffeeTea, y = Cholesterol, color = factor(Diabetes)))+
  geom_point(na.rm = TRUE)
```
These plots show the hours fasted 
```{r}
ggplot(data = Data_df, aes(x = Hrs_Food, y = Insulin, color = factor(Diabetes)))+
  geom_point(na.rm = TRUE)

ggplot(data = Data_df, aes(x = Hrs_Alcohol, y = Insulin, color = factor(Diabetes)))+
  geom_point(na.rm = TRUE)

ggplot(data = Data_df, aes(x = Hrs_CoffeeTea, y = Insulin, color = factor(Diabetes)))+
  geom_point(na.rm = TRUE)
```


```{r}
ggplot(data = Data_df, aes(x = Sex, y = Cholesterol))+
  geom_boxplot()
#boxplot of cholesterol for each sex 

ggplot(data = Data_df, aes(x = Sex, y = Insulin))+
  geom_bar(stat = "summary", fun = "mean")
#average insulin level for each sex
```



### Summary of Trends Observed so far

trends observed after initial visualization 
